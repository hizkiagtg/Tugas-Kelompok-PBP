{% load static %}
<!DOCTYPE html>
<html lang="en">
{% block content %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/accounts.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    {% block meta %}
    {% endblock meta %}
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
    integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
    crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js"
    integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz"
    crossorigin="anonymous"></script>

    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.0.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script> -->
    
    <style> 
        input {
            font-size: 11px;
            font-weight: 400;
        }
    </style>

    <!-- <script>
    $(document).ready(function() {
        $(document).on('submit', '#signup-form', function(e){
        // $("#signup-form").submit(function(e){
            e.preventDefault();
            var signup_form_id = $('#signup-form')

            $.ajax({
                type: 'POST',
                url: "{% url 'accounts:bank_signup' %}",
                // data: { csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()},
                data: signup_form_id.serialize(), 
                // csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
                dataType: "json",
                header: { 'X-CSRFToken': '{% csrf_token %}'},

                success: function (response) {

                    console.log(response)

                    if (response['success']) {
                        var message = "Anda berhasil terdaftar! Silahkan login.";
                        $('#allAlerts').append(message);
                    }
                    else {
                        if (response['error'] != null) {
                            for (var msg in response['error']) {
                                var txt = JSON.stringify(response['error'][msg]);
                                var row = `
                                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                        <span class="alert-text"> {{ txt }} </span>
                                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>`;
                            }
                            $('#allAlerts').append(row);
                            
                        }
                        else {
                            $('#allAlerts').append(response[warning]);
                        }
                    }
                    $("#allAlerts").html(data);
                    jQuery("#alertModal").modal('show');
                },
                
            });
        // };
        });
    });
    </script> -->

</head>

<body class="m-body">

    <script>
        $(document).ready(function() {
            $(document).on('submit', '#signup-form', function(e){
            // $("#signup-form").submit(function(e){
                e.preventDefault();
                var signup_form_id = $('#signup-form')
    
                $.ajax({
                    type: 'POST',
                    url: "./",
                    // data: { csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()},
                    data: $('#signup-form').serialize(), 
                    // csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
                    dataType: "json",
                    header: { 'X-CSRFToken': '{% csrf_token %}'},
    
                    success: function (response) {
                        alert(response);
                        if (response['success']) {
                            var message = "Anda berhasil terdaftar! Silahkan login.";
                            $('#allAlerts').append(message);
                        }
                        else {
                            if (response['error'] != null) {
                                for (var msg in response['error']) {
                                    var txt = JSON.stringify(response['error'][msg]);
                                    var row = `
                                        <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                            <span class="alert-text"> {{ txt }} </span>
                                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>`;
                                }
                                $('#allAlerts').append(row);
                                
                            }
                            else {
                                $('#allAlerts').append(response[warning]);
                            }
                        }
                        $("#allAlerts").html(data);
                        jQuery("#alertModal").modal('show');
                    },
                    
                });
            // };
            });
        });
        </script>
    
    <div class="login vh-100 d-flex justify-content-center align-items-center">
        <div class="card text-center mt-3 mb-3 mx-3 shadow" style="width: 42rem">
            {% if messages %}

            {% endif %}
            <h5 class="card-title mt-4 mb-0 fw-bold mr-5"> Create Account </h5>
            <div class="card-body p-4">
                <form method="POST">
                    {% csrf_token %}
                    <div class="table-responsive">
                        <table class="table table-borderless text-start vertical-align">
                            <form name="signup-form" class="form-signin" method="post" id="signup-form">{% csrf_token %}
                                <div>
                                    <label for="name">Nama Institusi:</label> <br>
                                    <input type="text" name="name" id="inputName" class="form-control"
                                        autocomplete="off" placeholder=""> <br>
                                </div>

                                <div class="col-md-12">
                                    <label for="email">Email:</label> <br>
                                    <input type="email" name="email" id="inputEmail" class="form-control" placeholder=""
                                        required autofocus> <br>
                                </div>

                                <div class="col-md-12">
                                    <label for="password1">Password:</label> <br>
                                    <input type="password" name="password1" id="inputPassword1" class="form-control"
                                        placeholder="" required> <br>
                                </div>

                                <div class="col-md-12">
                                    <label for="password2">Confirm Password:</label> <br>
                                    <input type="password" name="password2" id="inputPassword2" class="form-control"
                                        placeholder="" required><br>
                                </div>

                                <div class="col-md-12">
                                    <label for="city">Domisili (Kota):</label> <br>
                                    <input type="text" name="city" id="inputCity" class="form-control"
                                        placeholder=""><br>
                                </div>

                                <label for="address">Tell us how you heard about us:</label>
                                <br>
                                <textarea id="inputAddress" name="address" rows="4" cols="50" placeholder="Address">
                                </textarea><br>

                                <p id="error" style="color: red"></p>

                                <button class="btn btn-md btn-primary" id="reg-button" type="submit" >Register</button>

                            </form>

                        </table>
                    </div>


                    <!-- {% for message in messages %}
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <span class="alert-text">{{ message }}</span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    {% endfor %} -->
                    <!-- <input class="btn login_btn mt-2 mb-3"
                        style="background: #7f52a9; color:white; font-size: 15px; border-radius: 20px; width: 10rem"
                        onmouseover="this.style.backgroundColor='#555'"
                        onmouseout="this.style.backgroundColor='#7f52a9'" type="submit" name="submit" value="Daftar" /> -->
                </form>
            </div>
        </div>
    </div>

    <div class="row row-cols-md-3 mx-auto" id= "allAlerts" style="width: 95%">
    </div>

    <div class="modal fade" id="alertModal" tabindex="-1" aria-labelledby="alertModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
    
                <div class="modal-header">
                    <h4 class="modal-title mt-3 mb-2 fw-bold subtitle text-dark w-100 text-center"> Create new task!</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                        onclick="document.getElementById('allAlerts').empty();"></button>
                </div>
    
                <div class="row row-cols-md-3 mx-auto" id="allAlerts" style="width: 95%">
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
        crossorigin="anonymous"></script>
</body>
{% endblock content %}

</html>